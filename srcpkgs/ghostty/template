# Template file for 'ghostty'
pkgname=ghostty
version=1.2.0
revision=1
build_style=zig-build
configure_args="
 -Doptimize=ReleaseFast
 -Dpie
 -Dversion-string=${version}
 -fsys=freetype
 -fsys=fontconfig
 -fsys=harfbuzz"
hostmakedepends="pkg-config glib-devel pandoc blueprint-compiler gettext"
makedepends="fontconfig-devel freetype-devel harfbuzz-devel gtk4-devel gtk4-layer-shell-devel libadwaita-devel"
depends="ghostty-terminfo-${version}_${revision}"
short_desc="Fast and feature-rich terminal emulator that uses GPU acceleration"
maintainer="Duncaen <duncaen@voidlinux.org>"
license="MIT"
homepage="https://ghostty.org/"
distfiles="https://github.com/ghostty-org/ghostty/archive/refs/tags/v${version}.tar.gz"
checksum=02c3891e6e98d4666dd6d09338d01cb226d79c76ef904d5596fe5d9e92cfaac4

case "${XBPS_TARGET_MACHINE}" in
	armv*) broken="src/apprt/gtk/cgroup.zig:70:14: error: expected type 'usize', found 'u64'" ;;
esac


post_install() {
	vlicense LICENSE
	rm -f ${DESTDIR}/usr/share/man/.placeholder
}

ghostty-terminfo_package() {
	short_desc+=" - terminfo data"
	pkg_install() {
		vmove usr/share/terminfo
	}
}
